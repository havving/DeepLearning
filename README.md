# DeepLearning: 콘크리트 균열 탐지 시스템

콘크리트 구조물의 콘크리트 균열을 자동으로 탐지하고 균열 특성을 객관적으로 분석할 수 있습니다.



## 균열 진단 및 길이 측정

<img src="img\crack.png" width="500"></img>



## 딥러닝 모델을 이용한 균열 부위 특징 추출

<img src="img\deep_model.png" width="300"></img>



## CAD 파일 변환

<img src="img\cad.png" width="500"></img>



### 주요 기능

- 콘크리트 균열에 대한 공간 정보화
  - 균열 이미지 증강
  - 이미지 회전 및 변환
  - 균열 판별 인공지능 모델 학습 수행
  - 모델의 하이퍼 파라미터 조정 및 재학습
  - 학습 모델 검증 수행
- 발생 균열의 길이 측정
  - 균열 이미지에 대한 이미지 프로세싱을 통해 잡음 제거 및 길이 측정 기능 개발



### 기대 효과

자동 점검 기술의 도입으로 점검의 객관성 및 신뢰성을 보장할 수 있고 기존의 인력에 의한 업무를 대체함으로서 인건비를 감소시킬 수 있으며, 개발된 기술은 추후 범용적으로 확대 적용가능합니다.
- 업무적 효과
  - 인건비 감소 및 안전 문제 보장
  - 검사의 신뢰성 및 객관성 확보
- 기술적 효과
  - 다양한 형태의 콘크리트 구조물에 범용적으로 적용 가능


<br><br>
------------------------------------------------------------------------------------------------------------------
<br>


## 가중치 오차 함수를 통한 딥러닝 AutoEncoder 콘크리트 균열 학습 개선 방안

콘크리트의 균열 탐지를 위해 딥러닝 알고리즘 중 AutoEncoder 학습 시, 라벨 이미지의 균열 폭이 가늘게 있는 경우(2~3px 이하), 학습이 제대로 수행되지 않는 현상이 발생합니다. 이에 대해 오차함수에 가중치를 부여하여 모델 학습이 가능하도록 개선 방안을 제시했습니다.



#### AutoEncoder 평균 제곱 오차 함수로 학습한 경우

평균 제곱 오차 함수 사용 시, 마지막 행 이미지와 같이 미세한 균열에 대해서는 학습이 제대로 수행되지 않는 현상이 발생합니다.

<img src="img\before.png" width="300"></img>



#### 문제 해결방안

기존 오차 함수에 <b>가중치</b>를 부여하여 AutoEncoder 모델을 학습하도록 수행시킵니다. 라벨 이미지의 픽셀값이 0, 1에 따라 차등 가중치를 부여합니다. 라벨값 1에 대해 오차가 많이 발생한 경우에는 더욱 가중치를 늘립니다. 



##### 사용한 가중치 오차 함수

- Balanced Step 함수
- Squared&Balanced Step 함수
- Step 함수 
- ReLU 함수



#### 가중치 오차함수를 이용한 균열 분석 결과

가중치 오차 함수를 적용하여 균열을 추출한 결과, 균열 폭이 미세한 경우에도 균열을 추출하는 것을 육안으로 활인할 수 있게 되었습니다.

<img src="img\result.png" width="600"></img>



#### 결론

본 개선 방안은 예측값과 라벨값을 비교하여 산출된 오차 함수에 가중치를 부여하여 U-Net 모델을 학습 수행시켰고, 그 결과 오차를 최소화하고 미세한 균열까지 정확하게 학습하여 탐지해낼 수 있는 과정을 수행하였습니다. 인터넷에서 수집한 콘크리트 균열 이미지 2924장을 학습 데이터로 이용하여 정확도 99%이상, 조화평균 89~92%의 신뢰성 높은 수치를 기록하게 되었습니다.



> <b>조화평균</b>이란, 데이터가 불균형 구조일 때 모델의 성능을 정확하게 평가할 수 있는, 해당 모델이 얼마나 효과적인지 설명할 수 있는 분류 성능 평가 지표입니다. 재현율과 정밀도가 얼마나 조화를 이루는지, 한쪽으로 치우치지는 않았는지를 평가합니다. 한쪽으로 값이 치우치면 값이 낮게 나오게 되며, 값이 높을수록 좋은 성능의 모델이라 판단합니다. 본 개선 방안에서는 정확도보다 조화평균의 수치가 향상된 것에 의미를 부여합니다.
>
> > 재현율 : 실제 참(True)인 것 중, 모델이 참이라고 예측한 것의 비율 (미탐율)
> >
> > 정밀도 : 모델이 참(True)이라고 분류한 것 중, 실제 참인 것의 비율 (오탐률)
